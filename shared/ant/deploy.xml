<?xml version="1.0" encoding="UTF-8"?>

<!--
** Copy the following line to build script, correct path if needed
<import file="../../shared/ant/deploy.xml"/>

** Overwrite default jar target
<target depends="generate-jar" name="jar"/>

** To add automatic deployment, add one of the following lines 
<target depends="deploy-boundle-auto" name="-post-jar"/>
<target depends="deploy-boundle-manual" name="-post-jar"/>

** deploy scrips has default parameters but looks for 
   project specific overwrites in nbproject/deploy.properties
-->
<project name="deploy">
	
    <target name="-deploy-init">
	<dirname property="deploy.basedir" file="${ant.file.deploy}"/>
	<property file="${deploy.basedir}/deploy.properties"/>
        <property file="nbproject/deploy.properties"/>
    </target>
    
    <target name="deploy-boundle-auto">
      <copy todir="${deploy.auto.dir}" overwrite="true">
        <fileset dir="${deploy.bundle.dir}/"/>
      </copy>
    </target>
    
    <target name="deploy-boundle-manual">
      <copy todir="${deploy.manual.dir}" overwrite="true">
        <fileset dir="${deploy.bundle.dir}/"/>
      </copy>
    </target>
    
    <!-- TODO: Fix jar target overwrite instead of recompile after-->
    <target depends="init,compile,-pre-jar, bnd-generate, -post-jar" description="Build JAR." name="generate-jar"/>    
    
    <target depends="-deploy-init, compile" name="bnd-generate">
       <delete dir="${deploy.bundle.dir}"/>
       <mkdir dir="${deploy.bundle.dir}"/>
       <taskdef resource="aQute/bnd/ant/taskdef.properties" classpath="${deploy.bnd.jar}"/>
       <bnd 
         classpath="${build.classes.dir}"
         eclipse="false" 
         failok="false" 
         exceptions="true" 
         files="${deploy.bnd.file}"
         output="${deploy.bundle.dir}"/>
    </target>

</project>
